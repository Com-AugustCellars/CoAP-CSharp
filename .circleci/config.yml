version: 2
jobs:
  build:
    machine:
      image: microsoft/dotnet:2-sdk

    working_directory: ~/repo

    steps:
       - checkout

       - run:
           name: Enable IPv6
           command: |
              cat << 'EOF' | sudo tee /etc/docker/daemon.json
              {
                "ipv6": true
              }
              EOF
              systemctl reload docker

       - run:
           name: Get Examples
           command: git clone --depth 1 https://github.com/cose-wg/Examples Regressions

       - run:
           name: Unit Tests
           command: |
              dotnet test --framework=netcoreapp2.0 CoAP.Std10.sln
